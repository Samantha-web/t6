<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Production Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        background-color: #f9fafb;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 16px;
        font-family: Arial, sans-serif;
      }
      .container {
        max-width: 1280px;
        width: 100%;
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        padding: 32px;
      }
      .title {
        font-size: 1.875rem;
        font-weight: 700;
        color: #1f2937;
        margin-bottom: 32px;
        text-align: center;
      }
      .section-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #374151;
        margin-bottom: 16px;
      }
      .input-table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid #e5e7eb;
        margin-bottom: 16px;
      }
      .input-table th,
      .input-table td {
        border: 1px solid #e5e7eb;
        padding: 12px;
        font-size: 0.875rem;
        color: #4b5563;
        text-align: center;
      }
      .input-table th {
        font-weight: 500;
        background-color: #f3f4f6;
      }
      .input-table td select,
      .input-table td input {
        width: 100%;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        padding: 8px;
        text-align: center;
      }
      .input-table td select:focus,
      .input-table td input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
      }
      .readonly-div {
        margin-top: 4px;
        width: 100%;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        padding: 8px;
        background-color: #f3f4f6;
        color: #4b5563;
        text-align: center;
      }
      .table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid #e5e7eb;
      }
      .table th,
      .table td {
        border: 1px solid #e5e7eb;
        padding: 12px;
        font-size: 0.875rem;
        color: #4b5563;
      }
      .table th {
        font-weight: 500;
        background-color: #f3f4f6;
        text-align: left;
      }
      .table td {
        text-align: center;
      }
      .table select,
      .table input {
        width: 100%;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        padding: 8px;
      }
      .table select:focus,
      .table input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
      }
      .button-container {
        display: flex;
        justify-content: center;
        gap: 16px;
        margin: 20px 0;
      }
      .button {
        padding: 8px 24px;
        border-radius: 6px;
        color: #ffffff;
        font-weight: 500;
        transition: background-color 0.2s;
        cursor: pointer;
        border: none;
      }
      .button-blue {
        background-color: #2563eb;
      }
      .button-blue:hover {
        background-color: #1d4ed8;
      }
      .button-red {
        background-color: #dc2626;
      }
      .button-red:hover {
        background-color: #b91c1c;
      }
      .day-bg-0 {
        background-color: #dbeafe;
      }
      .day-bg-1 {
        background-color: #d1fae5;
      }
      .day-bg-2 {
        background-color: #fef9c3;
      }
      .day-bg-3 {
        background-color: #fce7f3;
      }
      .day-bg-4 {
        background-color: #ede9fe;
      }
      .day-bg-5 {
        background-color: #ccfbf1;
      }
      #footer {
        text-align: center;
        margin-top: 20px;
        padding: 10px;
        background-color: hsl(80, 13%, 95%);
        border-top: 1px solid #ccc;
      }
      .error-message {
        color: #dc2626;
        text-align: center;
        margin-bottom: 16px;
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <a
        href="https://samantha-web.github.io/navigationhub/"
        class="inline-block bg-purple-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-purple-700 transition duration-300"
        >Back to Home</a
      >
      <h1 class="title">Production Calculator T6(Alloy)</h1>
      <div id="errorMessage" class="error-message"></div>

      <!-- Input Table -->
      <div class="mb-8">
        <h2 class="section-title">Input Parameters</h2>
        <table class="input-table" id="inputTable">
          <thead>
            <tr>
              <th>Frame Size</th>
              <th>Loading Qty per Rack</th>
              <th>Order Quantity</th>
              <th>Number of Racks</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <select
                  id="frameSize0"
                  onchange="updateLoadingQty(0)"
                  aria-label="Frame Size 1"
                >
                  <option value="12">12</option>
                  <option value="14">14</option>
                  <option value="16">16</option>
                  <option value="18">18</option>
                  <option value="20">20</option>
                  <option value="24">24</option>
                  <option value="26">26</option>
                  <option value="27">27</option>
                  <option value="28">28</option>
                  <option value="29">29</option>
                  <option value="700">700</option>
                </select>
              </td>
              <td id="loadingQtyPerRack0">600</td>
              <td>
                <input
                  type="number"
                  id="orderQty0"
                  value="0"
                  min="0"
                  onchange="validateAndCalculate()"
                  aria-label="Order Quantity 1"
                />
              </td>
              <td
                id="numRacks0"
                class="readonly-div"
                aria-label="Number of Racks 1"
              >
                0.00
              </td>
            </tr>
            <tr>
              <td>
                <select
                  id="frameSize1"
                  onchange="updateLoadingQty(1)"
                  aria-label="Frame Size 2"
                >
                  <option value="12">12</option>
                  <option value="14">14</option>
                  <option value="16">16</option>
                  <option value="18">18</option>
                  <option value="20">20</option>
                  <option value="24">24</option>
                  <option value="26">26</option>
                  <option value="27">27</option>
                  <option value="28">28</option>
                  <option value="29">29</option>
                  <option value="700">700</option>
                </select>
              </td>
              <td id="loadingQtyPerRack1">600</td>
              <td>
                <input
                  type="number"
                  id="orderQty1"
                  value="0"
                  min="0"
                  onchange="validateAndCalculate()"
                  aria-label="Order Quantity 2"
                />
              </td>
              <td
                id="numRacks1"
                class="readonly-div"
                aria-label="Number of Racks 2"
              >
                0.00
              </td>
            </tr>
            <tr>
              <td>
                <select
                  id="frameSize2"
                  onchange="updateLoadingQty(2)"
                  aria-label="Frame Size 3"
                >
                  <option value="12">12</option>
                  <option value="14">14</option>
                  <option value="16">16</option>
                  <option value="18">18</option>
                  <option value="20">20</option>
                  <option value="24">24</option>
                  <option value="26">26</option>
                  <option value="27">27</option>
                  <option value="28">28</option>
                  <option value="29">29</option>
                  <option value="700">700</option>
                </select>
              </td>
              <td id="loadingQtyPerRack2">600</td>
              <td>
                <input
                  type="number"
                  id="orderQty2"
                  value="0"
                  min="0"
                  onchange="validateAndCalculate()"
                  aria-label="Order Quantity 3"
                />
              </td>
              <td
                id="numRacks2"
                class="readonly-div"
                aria-label="Number of Racks 3"
              >
                0.00
              </td>
            </tr>
            <tr>
              <td colspan="4">
                <button
                  onclick="addRow()"
                  class="button button-blue"
                  aria-label="Add Row"
                >
                  Add
                </button>
              </td>
            </tr>
            <tr>
              <td><strong>Total</strong></td>
              <td></td>
              <td
                id="totalOrderQty"
                class="readonly-div"
                aria-label="Total Order Quantity"
              >
                0
              </td>
              <td
                id="totalNumRacks"
                class="readonly-div"
                aria-label="Total Number of Racks"
              >
                0.00
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Days to Complete Table -->
      <div class="mb-8">
        <h2 class="section-title">Production Timeline</h2>
        <table class="table">
          <thead>
            <tr>
              <th>Parameter</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="label">Working Hours per Day</td>
              <td>
                <select
                  id="workingHours"
                  class="input"
                  onchange="validateAndCalculate()"
                  aria-label="Working Hours per Day"
                >
                  <option value="8">8 Hours</option>
                  <option value="10">10 Hours</option>
                  <option value="12">12 Hours</option>
                  <option value="14">14 Hours</option>
                  <option value="16">16 Hours</option>
                  <option value="18">18 Hours</option>
                  <option value="20">20 Hours</option>
                  <option value="22">22 Hours</option>
                  <option value="24">24 Hours</option>
                </select>
              </td>
            </tr>
            <tr>
              <td class="label">Today (mm/dd/yyyy)</td>
              <td id="today"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Buttons -->
      <div class="button-container">
        <button
          onclick="validateAndCalculate()"
          class="button button-blue"
          aria-label="Calculate"
        >
          Calculate
        </button>
        <button
          onclick="clearData()"
          class="button button-red"
          aria-label="Clear"
        >
          Clear
        </button>
      </div>

      <!-- Schedule Table -->
      <div class="mb-8">
        <h2 class="section-title">Production Schedule</h2>
        <table class="table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Rack Number</th>
              <th>Rack In Time</th>
              <th>Rack Out Time</th>
            </tr>
          </thead>
          <tbody id="scheduleBody">
            <!-- Dynamically generated rows -->
          </tbody>
        </table>
      </div>
      <hr class="my-6" />
      <footer id="footer" class="text-sm text-gray-600">
        Copyright Samantha 2025 © All rights reserved.<br />
        <a
          href="mailto:s2880882@gmail.com"
          class="text-blue-600 hover:underline"
          >s2880882@gmail.com (Samantha)</a
        >
      </footer>
    </div>

    <script type="text/javascript">
      const loadingQtyPerRackData = {
        12: 600,
        14: 550,
        16: 500,
        18: 500,
        20: 450,
        24: 400,
        26: 400,
        27: 375,
        28: 350,
        29: 350,
        700: 350,
      };

      function showError(message) {
        const errorDiv = document.getElementById("errorMessage");
        errorDiv.textContent = message;
        errorDiv.style.display = "block";
        setTimeout(() => {
          errorDiv.style.display = "none";
        }, 5000);
      }

      function validateAndCalculate() {
        try {
          const rowCount =
            document
              .getElementById("inputTable")
              .getElementsByTagName("tbody")[0]
              .getElementsByTagName("tr").length - 2;
          for (let i = 0; i < rowCount; i++) {
            const orderQty =
              parseInt(document.getElementById(`orderQty${i}`).value) || 0;
            if (orderQty < 0) {
              showError("Order quantity cannot be negative");
              return;
            }
          }
          calculate();
        } catch (error) {
          showError("Error during validation");
          console.error(error);
        }
      }

      function updateLoadingQty(rowIndex) {
        try {
          const frameSize = document.getElementById(
            `frameSize${rowIndex}`
          ).value;
          document.getElementById(`loadingQtyPerRack${rowIndex}`).textContent =
            loadingQtyPerRackData[frameSize];
          validateAndCalculate();
        } catch (error) {
          showError("Error updating loading quantity");
          console.error(error);
        }
      }

      function addRow() {
        try {
          const tbody = document
            .getElementById("inputTable")
            .getElementsByTagName("tbody")[0];
          const addRow =
            tbody.getElementsByTagName("tr")[tbody.rows.length - 2];
          const rowCount = tbody.getElementsByTagName("tr").length - 2;
          const newRow = document.createElement("tr");

          newRow.innerHTML = `
            <td>
              <select id="frameSize${rowCount}" onchange="updateLoadingQty(${rowCount})" aria-label="Frame Size ${
            rowCount + 1
          }">
                <option value="12">12</option>
                <option value="14">14</option>
                <option value="16">16</option>
                <option value="18">18</option>
                <option value="20">20</option>
                <option value="24">24</option>
                <option value="26">26</option>
                <option value="27">27</option>
                <option value="28">28</option>
                <option value="29">29</option>
                <option value="700">700</option>
              </select>
            </td>
            <td id="loadingQtyPerRack${rowCount}">600</td>
            <td>
              <input
                type="number"
                id="orderQty${rowCount}"
                value="0"
                min="0"
                onchange="validateAndCalculate()"
                aria-label="Order Quantity ${rowCount + 1}"
              />
            </td>
            <td id="numRacks${rowCount}" class="readonly-div" aria-label="Number of Racks ${
            rowCount + 1
          }">0.00</td>
          `;
          tbody.insertBefore(newRow, addRow);
          validateAndCalculate();
        } catch (error) {
          showError("Error adding new row");
          console.error(error);
        }
      }

      function calculate() {
        try {
          let totalOrderQty = 0;
          let totalNumRacks = 0;
          const rowCount =
            document
              .getElementById("inputTable")
              .getElementsByTagName("tbody")[0]
              .getElementsByTagName("tr").length - 2;

          for (let i = 0; i < rowCount; i++) {
            const orderQty =
              parseInt(document.getElementById(`orderQty${i}`).value) || 0;
            const loadingQtyPerRack =
              parseInt(
                document.getElementById(`loadingQtyPerRack${i}`).textContent
              ) || 0;
            const numRacks = loadingQtyPerRack
              ? orderQty / loadingQtyPerRack
              : 0;
            document.getElementById(`numRacks${i}`).textContent =
              numRacks.toFixed(2);
            totalOrderQty += orderQty;
            totalNumRacks += numRacks;
          }

          document.getElementById("totalOrderQty").textContent =
            totalOrderQty.toFixed(0);
          document.getElementById("totalNumRacks").textContent =
            totalNumRacks.toFixed(2);

          const workingHours =
            parseInt(document.getElementById("workingHours").value) || 8;
          const racksPerDay = Math.floor(workingHours / 2.5);

          updateSchedule(totalNumRacks, workingHours, racksPerDay);
        } catch (error) {
          showError("Error performing calculation");
          console.error(error);
        }
      }

      function updateSchedule(totalNumRacks, workingHours, racksPerDay) {
        try {
          const scheduleBody = document.getElementById("scheduleBody");
          scheduleBody.innerHTML = "";

          const rackIn1 = document.getElementById("rackIn1")?.value || "06:00";
          let [hours, minutes] = rackIn1.split(":").map(Number);
          let currentTime = new Date("2025-07-04");
          currentTime.setHours(hours, minutes, 0, 0);
          let currentDate = new Date("2025-07-04");
          let rackCount = 1;
          let racksToday = 0;
          let dayIndex = 0;

          const dateOptions = {
            month: "numeric",
            day: "numeric",
            year: "numeric",
          };
          const timeOptions = {
            hour: "2-digit",
            minute: "2-digit",
            hour12: true,
          };

          for (let i = 1; i <= Math.ceil(totalNumRacks); i++) {
            if (racksToday >= racksPerDay) {
              currentDate.setDate(currentDate.getDate() + 1);
              rackCount = 1;
              racksToday = 0;
              dayIndex = (dayIndex + 1) % 6;
              currentTime = new Date(currentDate);
              currentTime.setHours(hours, minutes, 0, 0);
            }

            const row = document.createElement("tr");
            const duration = 150;
            const rackOutTime = new Date(
              currentTime.getTime() + duration * 60000
            );

            row.innerHTML = `
              <td class="day-bg-${dayIndex}">${currentDate.toLocaleDateString(
              "en-US",
              dateOptions
            )}</td>
              <td>${rackCount}</td>
              <td>
                ${
                  i === 1
                    ? `<input type="time" class="input" id="rackIn1" value="${rackIn1}" onchange="validateAndCalculate()" aria-label="Rack In Time 1" />`
                    : `<span id="rackIn${i}" aria-label="Rack In Time ${i}">${currentTime.toLocaleTimeString(
                        "en-US",
                        timeOptions
                      )}</span>`
                }
              </td>
              <td id="rackOut${i}" aria-label="Rack Out Time ${i}">${rackOutTime.toLocaleTimeString(
              "en-US",
              timeOptions
            )}</td>
            `;
            scheduleBody.appendChild(row);

            currentTime = new Date(rackOutTime.getTime());
            rackCount++;
            racksToday++;
          }

          document.getElementById("today").textContent = new Date(
            "2025-07-04"
          ).toLocaleDateString("en-US", dateOptions);
        } catch (error) {
          showError("Error updating schedule");
          console.error(error);
        }
      }

      function clearData() {
        try {
          const tbody = document
            .getElementById("inputTable")
            .getElementsByTagName("tbody")[0];
          const rows = tbody.getElementsByTagName("tr");
          for (let i = 0; i < rows.length - 2; i++) {
            document.getElementById(`orderQty${i}`).value = "0";
            document.getElementById(`frameSize${i}`).value = "12";
            updateLoadingQty(i);
          }
          document.getElementById("workingHours").value = "8";
          const rackIn1 = document.getElementById("rackIn1");
          if (rackIn1) rackIn1.value = "06:00";
          validateAndCalculate();
        } catch (error) {
          showError("Error clearing data");
          console.error(error);
        }
      }

      // Initialize
      try {
        document.getElementById("today").textContent = new Date(
          "2025-07-04"
        ).toLocaleDateString("en-US");
        validateAndCalculate();
      } catch (error) {
        showError("Error initializing application");
        console.error(error);
      }
    </script>
  </body>
</html>
